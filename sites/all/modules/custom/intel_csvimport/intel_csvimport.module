<?php

/**
 * Implements hook_menu().
 */
function intel_csvimport_menu() {

$items = array();

$items['csvimport'] = array(
        'title' => 'CSV Import',
        'page callback' => 'csv_to_array',
        'type' => MENU_CALLBACK,
		'access callback' => TRUE,
    );
$items['csvimport-chinese'] = array(
        'title' => 'CSV Import - Chinese',
        'page callback' => 'csv_to_array_chinese',
        'type' => MENU_CALLBACK,
		'access callback' => TRUE,
    );
$items['csvimport-japanese'] = array(
        'title' => 'CSV Import - Japanese',
        'page callback' => 'csv_to_array_japanese',
        'type' => MENU_CALLBACK,
		'access callback' => TRUE,
    );
	  
  return $items;
}


/*
Creating insert,skip and delete script function
*/
function csv_to_array() {
	
	$form = drupal_get_form('csvImport_form');
   	$output = "<p>This tool will attempt to import CSV data";
    $output .= drupal_render($form);
    
    return $output;
	//print_r ($output);

}

function csvImport_form() {
    $form['#attributes'] = array(
      'enctype' => 'multipart/form-data'
    );
  
    $form['csvfile'] = array( 
      '#title' => t('CSV File'),
      '#type'  => 'file',
      '#description' => ($max_size = parse_size(ini_get('upload_max_filesize'))) ? t('Due to server restrictions, the <strong>maximum upload file size is !max_size</strong>. Files that exceed this size will be disregarded.', array('!max_size' => format_size($max_size))) : '',    
    ) ;
    $form['submit'] = array(
      '#type' => 'submit',
      '#value' => t('Commence Import'),
    ) ;
    $form['#validate'] = array(
      'csvImport_validate_fileupload',
      ///'csvImport_form_validate',
    ) ;
    return $form ;
  }
  
  function csvImport_validate_fileupload(&$form, &$form_state) {
   $validators = array(
      'file_validate_extensions' => array( 'csv txt xls xlsx'),
    );
    $destination = '';
	$file = file_save_upload('csvfile', $validators, "public://", FILE_EXISTS_RENAME);
	$destination = $file->destination;
    if ($file) {
      $form_state['values']['csvupload'] = $file->destination;       
    }
    else {
      form_set_error('csvImporter', t('Unable to copy upload file to !dest', array('!dest' => $destination)));
    }            
  }
  
    function csvImport_form_validate(&$form, &$form_state) {
    if ( isset( $form_state['values']['csvupload'] ) ) {
      if ( $handle = fopen($form_state['values']['csvupload'], 'r') ) {
        $line_count = 1 ;
        $first = TRUE ;
        if ( $line = fgetcsv($handle, 0,"\t")) {
  
          //-------------------------------------------------------------------------------------------|
          //  This is where you can validate aspects of the file itself, like the number of columns
          //-------------------------------------------------------------------------------------------|
            if(count($line) != 1939){
              form_set_error('csvfile', t('This file has the incorrect number of columns. Expecting 1939'));
            }
          //-------------------------------------------------------------------------------------------|
          //  End validating aspects of the CSV file
          //-------------------------------------------------------------------------------------------|
          
          
          
        }
        fclose($handle);
      }
      else {
        form_set_error('csvfile', t('Unable to read uploaded file !filepath', array('!filepath' => $form_state['values']['csvupload'])));
      }
    }
  }
    function csvImport_form_submit(&$form, &$form_state) {
	if ( isset( $form_state['values']['csvupload'] ) ) {
	$result = csv_to_array_form($form_state['values']['csvupload'] );
	 
	}
	}

/**
 * Read CSV file by converting array - Delta Extraction
 *
 */
function csv_to_array_form($file_name) {
    $message = $data = $header = array();
    $i = 0;
    $vid = 8000;
	
	//Set Table Name and Field name for terms
    $table_field_label = array(
        0 => array('table' => 'field_data_field_solution_type', 'field' => 'field_solution_type_value','revtbl' => 'field_revision_field_solution_type'),
        1 => array('table' => 'field_data_field_access', 'field' => 'field_access_value','revtbl' => 'field_revision_field_access'),
        2 => array('table' => 'field_data_field_categories', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_categories'),
        3 => array('table' => 'field_data_field_stds_audio', 'field' => 'field_stds_audio_tid','revtbl' => 'field_revision_field_stds_audio'),
        4 => array('table' => 'field_data_field_availability_pricing', 'field' => 'field_availability_pricing_tid','revtbl' => 'field_revision_field_availability_pricing'),
        5 => array('table' => 'field_data_field_power', 'field' => 'field_power_tid','revtbl' => 'field_revision_field_power'),
        6 => array('table' => 'field_data_field_chipsets', 'field' => 'field_chipsets_tid','revtbl' => 'field_revision_field_chipsets'),
        7 => array('table' => 'field_data_field_application', 'field' => 'field_application_tid','revtbl' => 'field_revision_field_application'),
        8 => array('table' => 'field_data_field_dimension', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_dimension'),//no table name change
        9 => array('table' => 'field_data_field_display', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_display'),//no table name change
        10 => array('table' => 'field_data_field_display_size', 'field' => 'field_display_size_tid','revtbl' => 'field_revision_field_display_size'),
        11 => array('table' => 'field_data_field_num_display_ports', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_num_display_ports'),//no table name change
        12 => array('table' => 'field_data_field_display_technology', 'field' => 'field_display_technology_tid','revtbl' => 'field_revision_field_display_technology'),
        13 => array('table' => 'field_data_field_embed_processor', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_embed_processor'),//no table name change
        14 => array('table' => 'field_data_field_end_user_organisation', 'field' => 'field_end_user_organisation_tid','revtbl' => 'field_revision_field_end_user_organisation'),
        15 => array('table' => 'field_data_field_ethernet_controllers', 'field' => 'field_ethernet_controllers_tid','revtbl' => 'field_revision_field_ethernet_controllers'),
        16 => array('table' => 'field_data_field_stds_eth', 'field' => 'field_stds_eth_tid','revtbl' => 'field_revision_field_stds_eth'),
        17 => array('table' => 'field_data_field_fpga', 'field' => 'field_fpga_tid','revtbl' => 'field_revision_field_fpga'),
        18 => array('table' => 'field_data_field_geographic_location', 'field' => 'field_geographic_location_tid','revtbl' => 'field_revision_field_geographic_location'),
        19 => array('table' => 'field_data_field_market_segments', 'field' => 'field_market_segments_tid','revtbl' => 'field_revision_field_market_segments'),
        20 => array('table' => 'field_data_field_intel_iot_market_ready_sol', 'field' => 'field_intel_iot_market_ready_sol_tid','revtbl' => 'field_revision_field_intel_iot_market_ready_sol'),
        21 => array('table' => 'field_data_field_intel_technologies', 'field' => 'field_intel_technologies_tid','revtbl' => 'field_revision_field_intel_technologies'),
        22 => array('table' => 'field_data_field_interconnect', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_interconnect'),//no table name change
        //23 => array('table' => 'field_data_field_memory_type', 'field' => 'field_memory_type_tid','revtbl' => 'field_revision_field_memory_type'),
		23 => array('table' => 'field_data_field_storage', 'field' => 'field_storage_tid','revtbl' => 'field_revision_field_storage'),
        24 => array('table' => 'field_data_field_opportunity_resource', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_opportunity_resource'),//no table name change
        25 => array('table' => 'field_data_field_stds_pcie_rev', 'field' => 'field_stds_pcie_rev_tid','revtbl' => 'field_revision_field_stds_pcie_rev'),
        26 => array('table' => 'field_data_field_processors_list', 'field' => 'field_processors_list_tid','revtbl' => 'field_revision_field_processors_list'),
        27 => array('table' => 'field_data_field_software_solutions', 'field' => 'field_software_solutions_tid','revtbl' => 'field_revision_field_software_solutions'),
        //28 => array('table' => 'field_data_field_storage', 'field' => 'field_storage_tid','revtbl' => 'field_revision_field_storage'),
		28 => array('table' => 'field_data_field_application', 'field' => 'field_application_tid','revtbl' => 'field_revision_field_application'),
        29 => array('table' => 'field_data_field_intel_wireless', 'field' => 'field_intel_wireless_tid','revtbl' => 'field_revision_field_intel_wireless'),
    );
	
	
    //Read File
    $file = fopen($file_name, 'r');
    while (($line = fgetcsv($file, 0, "\t")) !== FALSE) {
        if ($i == 0) {
            //Set header row
            $header = $line;
        } else {
            //Set Data rows
            //$data[] = $line;
			$operations[] = array(
          'intel_ea_taxonomy_migration_import_batch_processing',  // The function to run on each row
          array($header,$line,$table_field_label,$vid,$message),  // The row in the csv
        );
        
        $vid++;
        }
        $i++;
    }
    unset($line);
    fclose($file);

    //Map each header and Data with Nid coloumn
    // foreach($data as $key => $_value) {
        // $i = 0;
        // $new_item = array();
        // foreach($_value as $key => $value) {
            // $new_item[$i]['label'] = $header[$key];
            // $new_item[$i]['value'] = $value;
	// $i++;
        // }
        // $_data[] = $new_item;
    // }
    // unset($data);
    // unset($new_item);
    // unset($header);
    // foreach($_data as $value) {
	
	 // $operations[] = array(
          // 'intel_ea_taxonomy_migration_import_batch_processing',  // The function to run on each row
          // array($value,$table_field_label,$vid,$message),  // The row in the csv
        // );
        
        // $vid++;
    // }
	// Once everything is gathered and ready to be processed... well... process it!
      $batch = array(
        'title' => t('Importing CSV...'),
        'operations' => $operations,  // Runs all of the queued processes from the while loop above.
        'finished' => 'module_name_import_finished', // Function to run when the import is successful
        'error_message' => t('The installation has encountered an error.'),
        'progress_message' => t('Imported @current of @total products.'),
      );
      batch_set($batch);
	//batch_process('csvimport');
	
    return $message;
    //return $_data;
}
/**
 * Check Delta exists for correponding values - Delta should be unique combine with entity id
 *
 */
function delta_exists($tblname, $nid, &$entity_id) {
    $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
    //Get records of delta id for an entity id
    $sql = "SELECT entity_id FROM {$tblname} WHERE entity_id=$nid AND delta=:count_nid limit 1";
	//drupal_set_message($sql);
    if ($result = db_query($sql,array(':count_nid'=>$count_nid))) {
        // Return the number of rows in result set
        $rowcount = $result -> rowCount();
        if ($rowcount) {
            //Get maximum delta value for an entity id
           $sql = "SELECT max(delta) as max FROM {$tblname} WHERE entity_id=:nid limit 1";
	   //drupal_set_message($sql);
            if ($result = db_query($sql,array(':nid'=>$nid))) {
               foreach ($result as $result) {
	// Do something with each $result
	$max = $result->max;
	}
                $entity_id[$nid]['delta_id'][$max + 1] = 'old delta Exists';
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                $entity_id[$nid]['delta_flag'] = true;
            }
        }

    }

}
/* 
Delete Message
*/

function delete_rows($table,$nid,$field,$data_label_value) {
	$delete_flag = false;
     $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=:data_label_value limit 1";
                if ($result = db_query($sql,array(':data_label_value'=>$data_label_value))) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                       $delete_flag = true;
                    }	
	}
	return $delete_flag;
}

  function module_name_import_finished($success, $results, $operations) {
	 
	 drupal_set_message(t('Import Completed'));
	
	theme('csvimport_template', array('result' => $results));
	 
	   
  }
/**
* Check nid have translated nids
*
*/
function get_translated_nids_with_language($nid) {
$nids = array();
$translated_node_id = db_query('SELECT tnid FROM node WHERE nid=:nid', array(':nid' => $nid))->fetchField();//get language code

if($translated_node_id)
{
                $result = "SELECT nid,language FROM node WHERE tnid=:tnid";
                if ($result = db_query($result,array(':tnid'=>$translated_node_id))) {
                                                                                  
                  foreach ($result as $node) {
                                $nids[$node->language] = $node->nid;
                  }
                }
}
else{
                $language_code = db_query('SELECT language FROM {node} WHERE nid = :nid ORDER BY vid DESC LIMIT 0,1', array(':nid' => $nid))->fetchField();
                $nids[$language_code] = $nid;
}
return $nids;
}


    function intel_ea_taxonomy_migration_import_batch_processing($header,$value,$table_field_label,$vid,$message,&$context) {
		 $nid = $value[0];
		 $language = 'und';
		 if(!in_array($nid,$context['results']['completed_nids']))
		 {
			//$message[$nid]['h_tanaslation'] []="$nid has translated Node for $nid";
			$vid = db_query('SELECT max(vid) as vid  FROM {node_revision} WHERE nid = :nid ORDER BY vid DESC LIMIT 0,1', array(':nid' => $nid))->fetchField(); 
	
		//Generate Script for Solution Types
         for ($i = 3; $i <= 5; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

             //Set corresponding label values
			if ($data_label == 'Client') $data_label_value = 'client';
			if ($data_label == 'Server') $data_label_value = 'server';
			if ($data_label == 'IoT') $data_label_value = 'embedded iot';
			
			
			$table = $table_field_label[0]['table'];
			$revtbl = $table_field_label[0]['revtbl'];
			$field = $table_field_label[0]['field'];
			
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=:data_label_value";
                if ($result = db_query($sql,array(':data_label_value'=>$data_label_value))) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
						//drupal_set_message('skip'.$count_nid);
                        //Skip Message                                                                 
                        //$message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
               $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
                      $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						//drupal_set_message("count$nid--$delta_value--$data_label_value--".$entity_id[$table][$nid]['delta_flag']);
                        //Insert Message
						if(empty($vid)){
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }

            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
				//if($delete_flag) 
                //$message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field='$data_label_value'";
            
	}	

        }
       

        //Generate Script for View Options
          for ($i = 6; $i <= 8; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            if ($data_label == 'Intel Content') $data_label_value = 2;
            if ($data_label == 'Logged In Content') $data_label_value = 1;
            if ($data_label == 'Public Content') $data_label_value = 0;
			 $table = $table_field_label[1]['table'];
			$revtbl = $table_field_label[1]['revtbl'];
			$field = $table_field_label[1]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                                                 
                        //$message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
               
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
               $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                        //Insert Message
						if(empty($vid)){
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
	

                    }
                }

            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
				//if($delete_flag) 
                //$message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
		
        //Generate Script for Category terms
        for ($i = 9; $i <= 183; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
			$data_label_value = explode("~", $data_label);
			$data_label_value = $data_label_value[0];
			
			
			$table = $table_field_label[2]['table'];
			$revtbl = $table_field_label[2]['revtbl'];
			$field = $table_field_label[2]['field'];
			
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
						//drupal_set_message('skip'.$count_nid);
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
               $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                          delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						//drupal_set_message("count$nid--$delta_value--$data_label_value--".$entity_id[$table][$nid]['delta_flag']);
                        //Insert Message
						if(empty($vid)){
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }

            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
        //Generate Script for Characteristics: Audio Standards terms
        for ($i = 184; $i <= 187; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[3]['table'];
			$revtbl = $table_field_label[3]['revtbl'];
			$field = $table_field_label[3]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
               $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                          delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
                        
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Availability & Pricing terms
        for ($i = 188; $i <= 199; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[4]['table'];
				$revtbl = $table_field_label[4]['revtbl'];
                $field = $table_field_label[4]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
               $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
                       
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Battery
        for ($i = 200; $i <= 203; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[5]['table'];
				$revtbl = $table_field_label[5]['revtbl'];
                $field = $table_field_label[5]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Chipsets
        for ($i = 204; $i <= 306; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[6]['table'];
				$revtbl = $table_field_label[6]['revtbl'];
                $field = $table_field_label[6]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Devices and Interfaces 
        for ($i = 307; $i <= 441; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[7]['table'];
				$revtbl = $table_field_label[7]['revtbl'];
                $field = $table_field_label[7]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Dimensions 
       /* for ($i = 442; $i <= 445; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[8]['table'];
				$revtbl = $table_field_label[8]['revtbl'];
                $field = $table_field_label[8]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics:// Display 
        for ($i = 446; $i <= 479; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[9]['table'];
				$revtbl = $table_field_label[9]['revtbl'];
                $field = $table_field_label[9]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                 //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
                      
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }*/
        //Generate Script for Characteristics:// Display Size 
        for ($i = 480; $i <= 529; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[10]['table'];
				$revtbl = $table_field_label[10]['revtbl'];
                $field = $table_field_label[10]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics:// Number of Display Ports/EDP Ports
        /*for ($i = 530; $i <= 535; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[11]['table'];
				$revtbl = $table_field_label[11]['revtbl'];
                $field = $table_field_label[11]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }*/

        //Generate Script for Characteristics:// Display Technology
        for ($i = 536; $i <= 644; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[12]['table'];
				$revtbl = $table_field_label[12]['revtbl'];
                $field = $table_field_label[12]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Embedded IA Processor Support
        /*for ($i = 645; $i <= 657; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			 $table = $table_field_label[13]['table'];
	$revtbl = $table_field_label[13]['revtbl'];
                $field = $table_field_label[13]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		*/
        //Generate Script for Characteristics: // End User Organisation
        for ($i = 658; $i <= 662; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[14]['table'];
	$revtbl = $table_field_label[14]['revtbl'];
                $field = $table_field_label[14]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        } 

        //Generate Script for Characteristics: // Ethernet Controllers
        for ($i = 663; $i <= 721; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[15]['table'];
	$revtbl = $table_field_label[15]['revtbl'];
                $field = $table_field_label[15]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Ethernet Standards
        for ($i = 722; $i <= 727; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[16]['table'];
	$revtbl = $table_field_label[16]['revtbl'];
                $field = $table_field_label[16]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // FPGA
        for ($i = 728; $i <= 744; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[17]['table'];
	$revtbl = $table_field_label[17]['revtbl'];
                $field = $table_field_label[17]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Geographic Coverage:
        for ($i = 745; $i <= 770; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[18]['table'];
	$revtbl = $table_field_label[18]['revtbl'];
                $field = $table_field_label[18]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Industries and Applications
        for ($i = 771; $i <= 887; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[19]['table'];
	$revtbl = $table_field_label[19]['revtbl'];
                $field = $table_field_label[19]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
        //Generate Script for Characteristics: // Intel IoT Market Ready Solutions
        for ($i = 888; $i <= 888; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[20]['table'];
	$revtbl = $table_field_label[20]['revtbl'];
                $field = $table_field_label[20]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                               delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Intel Technologies
        for ($i = 889; $i <= 908; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[21]['table'];
	$revtbl = $table_field_label[21]['revtbl'];
                $field = $table_field_label[21]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Interconnect
        /*for ($i = 909; $i <= 938; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[22]['table'];
	$revtbl = $table_field_label[22]['revtbl'];
                $field = $table_field_label[22]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
*/
        //Generate Script for Characteristics: // Memory
        for ($i = 939; $i <= 963; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[23]['table'];
	$revtbl = $table_field_label[23]['revtbl'];
                $field = $table_field_label[23]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Opportunity Resource Type
      /*  for ($i = 964; $i <= 973; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[24]['table'];
	$revtbl = $table_field_label[24]['revtbl'];
                $field = $table_field_label[24]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
*/
        //Generate Script for Characteristics: // PCIe Revisions
        for ($i = 974; $i <= 977; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[25]['table'];
	$revtbl = $table_field_label[25]['revtbl'];
                $field = $table_field_label[25]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
             
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
       // Generate Script for Characteristics: // Processors
        for ($i = 978; $i <= 1774; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[26]['table'];
	$revtbl = $table_field_label[26]['revtbl'];
                $field = $table_field_label[26]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Software Solutions
        for ($i = 1775; $i <= 1808; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[27]['table'];
	$revtbl = $table_field_label[27]['revtbl'];
                $field = $table_field_label[27]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Storage:
        for ($i = 1809; $i <= 1838; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[28]['table'];
	$revtbl = $table_field_label[28]['revtbl'];
                $field = $table_field_label[28]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                               delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
	
            
	}	
        }
		
        //Generate Script for Characteristics: // Wireless
        for ($i = 1839; $i <= 1882; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[29]['table'];
	$revtbl = $table_field_label[29]['revtbl'];
                $field = $table_field_label[29]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                $delta_value = 0;
                
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						 $delta_value = 0;
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		
		
		
		
		/***** MISSING TAXONOMY ITEMS STARTS HERE ************/
		
		// Generate Script for Characteristics: // Intel Technologies missing
        for ($i = 1941; $i <= 1941; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[21]['table'];
			$revtbl = $table_field_label[21]['revtbl'];
            $field = $table_field_label[21]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
                
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		
		// Generate Script for Characteristics: // Industries and Applications missing
        for ($i = 1942; $i <= 1943; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[19]['table'];
	$revtbl = $table_field_label[19]['revtbl'];
                $field = $table_field_label[19]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
                
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                             delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
		
		/*
		
		//Generate Script for Characteristics:// Display missing
        for ($i = 1944; $i <= 1944; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[9]['table'];
				$revtbl = $table_field_label[9]['revtbl'];
                $field = $table_field_label[9]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
                
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		*/
		/*
		//Generate Script for Characteristics: // Devices and Interfaces missing
        for ($i = 1945; $i <= 1952; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[7]['table'];
				$revtbl = $table_field_label[7]['revtbl'];
                $field = $table_field_label[7]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
                
                $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                              delta_exists($table, $nid, $entity_id[$table]);
                       $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
                  
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		*/
		
		
		//Generate Script for Characteristics: // Storage missing
		for ($i = 1953; $i <= 1955; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[28]['table'];
				$revtbl = $table_field_label[28]['revtbl'];
                $field = $table_field_label[28]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
	
            
	}	
        }
		
		
		
		/***** MISSING TAXONOMY ITEMS ENDS HERE ************/
		
		
		
		$context['results']['completed_nids'][] = $nid;
		if(count($message[$nid]['insert']) > 0)
		$context['results']['message'][$nid]['insert'][] = $message[$nid]['insert'];
		if(count($message[$nid]['skip']) > 0)
			$context['results']['message'][$nid]['skip'][] = $message[$nid]['skip'];
		if(count($message[$nid]['delete']) > 0)
			$context['results']['message'][$nid]['delete'][] = $message[$nid]['delete'];
		if(count($message[$nid]['h_tanaslation']) > 0)
			$context['results']['message'][$nid]['h_tanaslation'][] = $message[$nid]['h_tanaslation'];
			//unset($entity_id);
		if(count($message[$nid]['no-nid']) > 0)
		$context['results']['message'][$nid]['no-nid'][] = $message[$nid]['no-nid'];
		unset($message);
	}
		 
	}
	
	
/*
Creating insert,skip and delete script function for chinese language
*/
function csv_to_array_chinese() {
	
	$form = drupal_get_form('csvImport_chinese_form');
   	$output = "<p>This tool will attempt to import CSV data";
    $output .= drupal_render($form);
    
    return $output;
	//print_r ($output);

  

}

function csvImport_chinese_form() {
    $form['#attributes'] = array(
      'enctype' => 'multipart/form-data'
    );
  
    $form['csvfile'] = array( 
      '#title' => t('CSV File'),
      '#type'  => 'file',
      '#description' => ($max_size = parse_size(ini_get('upload_max_filesize'))) ? t('Due to server restrictions, the <strong>maximum upload file size is !max_size</strong>. Files that exceed this size will be disregarded.', array('!max_size' => format_size($max_size))) : '',    
    ) ;
    $form['submit'] = array(
      '#type' => 'submit',
      '#value' => t('Commence Import'),
    ) ;
    $form['#validate'] = array(
      'csvImport_chinese_validate_fileupload',
      ///'csvImport_form_validate_chinese',
    ) ;
    return $form ;
  }
  
  function csvImport_chinese_validate_fileupload(&$form, &$form_state) {
   $validators = array(
      'file_validate_extensions' => array( 'csv txt xls xlsx'),
    );
    $destination = '';
	$file = file_save_upload('csvfile', $validators, "public://", FILE_EXISTS_RENAME);
	$destination = $file->destination;
    if ($file) {
      $form_state['values']['csvupload'] = $file->destination;       
    }
    else {
      form_set_error('csvImporter', t('Unable to copy upload file to !dest', array('!dest' => $destination)));
    }            
  }
  
    function csvImport_form_validate_chinese(&$form, &$form_state) {
    if ( isset( $form_state['values']['csvupload'] ) ) {
      if ( $handle = fopen($form_state['values']['csvupload'], 'r') ) {
        $line_count = 1 ;
        $first = TRUE ;
        if ( $line = fgetcsv($handle, 0,"\t")) {
  
          //-------------------------------------------------------------------------------------------|
          //  This is where you can validate aspects of the file itself, like the number of columns
          //-------------------------------------------------------------------------------------------|
            if(count($line) != 1939){
              form_set_error('csvfile', t('This file has the incorrect number of columns. Expecting 1939'));
            }
          //-------------------------------------------------------------------------------------------|
          //  End validating aspects of the CSV file
          //-------------------------------------------------------------------------------------------|
          
          
          
        }
        fclose($handle);
      }
      else {
        form_set_error('csvfile', t('Unable to read uploaded file !filepath', array('!filepath' => $form_state['values']['csvupload'])));
      }
    }
  }
    function csvImport_chinese_form_submit(&$form, &$form_state) {
	if ( isset( $form_state['values']['csvupload'] ) ) {
	$result = csv_to_array_form_chinese($form_state['values']['csvupload'] );
	 
	}
	}

/**
 * Read CSV file by converting array - Delta Extraction
 *
 */
function csv_to_array_form_chinese($file_name) {
    $message = $data = $header = array();
    $i = 0;
    $vid = 8000;
	
	//Set Table Name and Field name for terms
    $table_field_label = array(
        0 => array('table' => 'field_data_field_solution_type', 'field' => 'field_solution_type_value','revtbl' => 'field_revision_field_solution_type'),
        1 => array('table' => 'field_data_field_access', 'field' => 'field_access_value','revtbl' => 'field_revision_field_access'),
        2 => array('table' => 'field_data_field_categories', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_categories'),
        3 => array('table' => 'field_data_field_stds_audio', 'field' => 'field_stds_audio_tid','revtbl' => 'field_revision_field_stds_audio'),
        4 => array('table' => 'field_data_field_availability_pricing', 'field' => 'field_availability_pricing_tid','revtbl' => 'field_revision_field_availability_pricing'),
        5 => array('table' => 'field_data_field_power', 'field' => 'field_power_tid','revtbl' => 'field_revision_field_power'),
        6 => array('table' => 'field_data_field_chipsets', 'field' => 'field_chipsets_tid','revtbl' => 'field_revision_field_chipsets'),
        7 => array('table' => 'field_data_field_application', 'field' => 'field_application_tid','revtbl' => 'field_revision_field_application'),
        8 => array('table' => 'field_data_field_dimension', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_dimension'),//no table name change
        9 => array('table' => 'field_data_field_display', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_display'),//no table name change
        10 => array('table' => 'field_data_field_display_size', 'field' => 'field_display_size_tid','revtbl' => 'field_revision_field_display_size'),
        11 => array('table' => 'field_data_field_num_display_ports', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_num_display_ports'),//no table name change
        12 => array('table' => 'field_data_field_display_technology', 'field' => 'field_display_technology_tid','revtbl' => 'field_revision_field_display_technology'),
        13 => array('table' => 'field_data_field_embed_processor', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_embed_processor'),//no table name change
        14 => array('table' => 'field_data_field_end_user_organisation', 'field' => 'field_end_user_organisation_tid','revtbl' => 'field_revision_field_end_user_organisation'),
        15 => array('table' => 'field_data_field_ethernet_controllers', 'field' => 'field_ethernet_controllers_tid','revtbl' => 'field_revision_field_ethernet_controllers'),
        16 => array('table' => 'field_data_field_stds_eth', 'field' => 'field_stds_eth_tid','revtbl' => 'field_revision_field_stds_eth'),
        17 => array('table' => 'field_data_field_fpga', 'field' => 'field_fpga_tid','revtbl' => 'field_revision_field_fpga'),
        18 => array('table' => 'field_data_field_geographic_location', 'field' => 'field_geographic_location_tid','revtbl' => 'field_revision_field_geographic_location'),
        19 => array('table' => 'field_data_field_market_segments', 'field' => 'field_market_segments_tid','revtbl' => 'field_revision_field_market_segments'),
        20 => array('table' => 'field_data_field_intel_iot_market_ready_sol', 'field' => 'field_intel_iot_market_ready_sol_tid','revtbl' => 'field_revision_field_intel_iot_market_ready_sol'),
        21 => array('table' => 'field_data_field_intel_technologies', 'field' => 'field_intel_technologies_tid','revtbl' => 'field_revision_field_intel_technologies'),
        22 => array('table' => 'field_data_field_interconnect', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_interconnect'),//no table name change
        //23 => array('table' => 'field_data_field_memory_type', 'field' => 'field_memory_type_tid','revtbl' => 'field_revision_field_memory_type'),
		23 => array('table' => 'field_data_field_storage', 'field' => 'field_storage_tid','revtbl' => 'field_revision_field_storage'),
        24 => array('table' => 'field_data_field_opportunity_resource', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_opportunity_resource'),//no table name change
        25 => array('table' => 'field_data_field_stds_pcie_rev', 'field' => 'field_stds_pcie_rev_tid','revtbl' => 'field_revision_field_stds_pcie_rev'),
        26 => array('table' => 'field_data_field_processors_list', 'field' => 'field_processors_list_tid','revtbl' => 'field_revision_field_processors_list'),
        27 => array('table' => 'field_data_field_software_solutions', 'field' => 'field_software_solutions_tid','revtbl' => 'field_revision_field_software_solutions'),
        //28 => array('table' => 'field_data_field_storage', 'field' => 'field_storage_tid','revtbl' => 'field_revision_field_storage'),
		28 => array('table' => 'field_data_field_application', 'field' => 'field_application_tid','revtbl' => 'field_revision_field_application'),
        29 => array('table' => 'field_data_field_intel_wireless', 'field' => 'field_intel_wireless_tid','revtbl' => 'field_revision_field_intel_wireless'),
    );
	
	
    //Read File
    $file = fopen($file_name, 'r');
    while (($line = fgetcsv($file, 0, "\t")) !== FALSE) {
        if ($i == 0) {
            //Set header row
            $header = $line;
        } else {
            //Set Data rows
            //$data[] = $line;
			$operations[] = array(
          'intel_ea_taxonomy_migration_import_batch_processing_chinese',  // The function to run on each row
          array($header,$line,$table_field_label,$vid,$message),  // The row in the csv
        );
        
        $vid++;
        }
        $i++;
    }
    unset($line);
    fclose($file);

    //Map each header and Data with Nid coloumn
    // foreach($data as $key => $_value) {
        // $i = 0;
        // $new_item = array();
        // foreach($_value as $key => $value) {
            // $new_item[$i]['label'] = $header[$key];
            // $new_item[$i]['value'] = $value;
	// $i++;
        // }
        // $_data[] = $new_item;
    // }
    // unset($data);
    // unset($new_item);
    // unset($header);
    // foreach($_data as $value) {
	
	 // $operations[] = array(
          // 'intel_ea_taxonomy_migration_import_batch_processing',  // The function to run on each row
          // array($value,$table_field_label,$vid,$message),  // The row in the csv
        // );
        
        // $vid++;
    // }
	// Once everything is gathered and ready to be processed... well... process it!
      $batch = array(
        'title' => t('Importing CSV...'),
        'operations' => $operations,  // Runs all of the queued processes from the while loop above.
        'finished' => 'module_name_import_finished', // Function to run when the import is successful
        'error_message' => t('The installation has encountered an error.'),
        'progress_message' => t('Imported @current of @total products.'),
      );
      batch_set($batch);
	//batch_process('csvimport');
	
    return $message;
    //return $_data;
}
/**
 * Check Delta exists for correponding values - Delta should be unique combine with entity id
 *
 */
function delta_exists_chinese($tblname, $nid, &$entity_id) {
    $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
    //Get records of delta id for an entity id
    $sql = "SELECT entity_id FROM {$tblname} WHERE entity_id=$nid AND delta=:count_nid limit 1";
	//drupal_set_message($sql);
    if ($result = db_query($sql,array(':count_nid'=>$count_nid))) {
        // Return the number of rows in result set
        $rowcount = $result -> rowCount();
        if ($rowcount) {
            //Get maximum delta value for an entity id
           $sql = "SELECT max(delta) as max FROM {$tblname} WHERE entity_id=:nid limit 1";
	   //drupal_set_message($sql);
            if ($result = db_query($sql,array(':nid'=>$nid))) {
               foreach ($result as $result) {
	// Do something with each $result
	$max = $result->max;
	}
                $entity_id[$nid]['delta_id'][$max + 1] = 'old delta Exists';
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                $entity_id[$nid]['delta_flag'] = true;
            }
        }

    }

}
/* 
Delete Message
*/

function delete_rows_chinese($table,$nid,$field,$data_label_value) {
	$delete_flag = false;
     $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=:data_label_value limit 1";
                if ($result = db_query($sql,array(':data_label_value'=>$data_label_value))) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                       $delete_flag = true;
                    }	
	}
	return $delete_flag;
}

  function module_name_import_finished_chinese($success, $results, $operations) {
	 
	 drupal_set_message(t('Import Completed'));
	
	theme('csvimport_template', array('result' => $results));
	 
	   
  }


    function intel_ea_taxonomy_migration_import_batch_processing_chinese($header,$value,$table_field_label,$vid,$message,&$context) {
		 $nid = $value[0];
                                $source_nid = $value[0]; // preserve source nid for displaying translated message etc.,
                                $language = 'und';
                                
                                /* Multilingual */
                                $other_lang_nid = get_translated_nids_with_language($nid); // get nid as array
                                
                                
                                if (!array_key_exists('zh-hans', $other_lang_nid)) {
                                                return;
                                }
                                $nid = $other_lang_nid['zh-hans'];
                                

                                                
                                //Prevent same nid process again if translated nids occurs in excel
                                if(!in_array($nid,$context['results']['completed_nids']))
                                {
									 $vid = db_query('SELECT max(vid) as vid  FROM {node_revision} WHERE nid = :nid ORDER BY vid DESC LIMIT 0,1', array(':nid' => $nid))->fetchField();                                                           
                                                 //Display translation message
                                                if($nid != $source_nid){
													$language_code = db_query('SELECT language FROM {node} WHERE nid = :nid ORDER BY vid DESC LIMIT 0,1', array(':nid' => $nid))->fetchField();//get language code
                                                $language_name = db_query('SELECT name FROM languages WHERE language=:language_code LIMIT 0,1', array(':language_code' => $language_code))->fetchField();// get language name
                                                                $message[$nid]['h_tanaslation']="Node-$nid is translated node - $language_name of node-$source_nid";
												}


			 
		//Generate Script for Solution Types
         for ($i = 3; $i <= 5; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

             //Set corresponding label values
			if ($data_label == 'Client') $data_label_value = 'client';
			if ($data_label == 'Server') $data_label_value = 'server';
			if ($data_label == 'IoT') $data_label_value = 'embedded iot';
			
			
			$table = $table_field_label[0]['table'];
			$revtbl = $table_field_label[0]['revtbl'];
			$field = $table_field_label[0]['field'];
			
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=:data_label_value";
                if ($result = db_query($sql,array(':data_label_value'=>$data_label_value))) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
						//drupal_set_message('skip'.$count_nid);
                        //Skip Message                                                                 
                        //$message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						//drupal_set_message("count$nid--$delta_value--$data_label_value--".$entity_id[$table][$nid]['delta_flag']);
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }

            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
				//if($delete_flag) 
                //$message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field='$data_label_value'";
            
	}	

        }
       

        //Generate Script for View Options
          for ($i = 6; $i <= 8; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            if ($data_label == 'Intel Content') $data_label_value = 2;
            if ($data_label == 'Logged In Content') $data_label_value = 1;
            if ($data_label == 'Public Content') $data_label_value = 0;
			 $table = $table_field_label[1]['table'];
			$revtbl = $table_field_label[1]['revtbl'];
			$field = $table_field_label[1]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                                                 
                        //$message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
							$delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }

            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
				//if($delete_flag) 
                //$message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
		
        //Generate Script for Category terms
        for ($i = 9; $i <= 183; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
			$data_label_value = explode("~", $data_label);
			$data_label_value = $data_label_value[0];
			
			
			$table = $table_field_label[2]['table'];
			$revtbl = $table_field_label[2]['revtbl'];
			$field = $table_field_label[2]['field'];
			
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
						//drupal_set_message('skip'.$count_nid);
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						//drupal_set_message("count$nid--$delta_value--$data_label_value--".$entity_id[$table][$nid]['delta_flag']);
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }

            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
        //Generate Script for Characteristics: Audio Standards terms
        for ($i = 184; $i <= 187; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[3]['table'];
			$revtbl = $table_field_label[3]['revtbl'];
			$field = $table_field_label[3]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Availability & Pricing terms
        for ($i = 188; $i <= 199; $i++) {
            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[4]['table'];
				$revtbl = $table_field_label[4]['revtbl'];
                $field = $table_field_label[4]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Battery
        for ($i = 200; $i <= 203; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[5]['table'];
				$revtbl = $table_field_label[5]['revtbl'];
                $field = $table_field_label[5]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Chipsets
        for ($i = 204; $i <= 306; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[6]['table'];
				$revtbl = $table_field_label[6]['revtbl'];
                $field = $table_field_label[6]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
  						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Devices and Interfaces 
        for ($i = 307; $i <= 441; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[7]['table'];
				$revtbl = $table_field_label[7]['revtbl'];
                $field = $table_field_label[7]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Dimensions 
       /* for ($i = 442; $i <= 445; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[8]['table'];
				$revtbl = $table_field_label[8]['revtbl'];
                $field = $table_field_label[8]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
             
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics:// Display 
        for ($i = 446; $i <= 479; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[9]['table'];
				$revtbl = $table_field_label[9]['revtbl'];
                $field = $table_field_label[9]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }*/
        //Generate Script for Characteristics:// Display Size 
        for ($i = 480; $i <= 529; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[10]['table'];
				$revtbl = $table_field_label[10]['revtbl'];
                $field = $table_field_label[10]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics:// Number of Display Ports/EDP Ports
        /*for ($i = 530; $i <= 535; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[11]['table'];
				$revtbl = $table_field_label[11]['revtbl'];
                $field = $table_field_label[11]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }*/

        //Generate Script for Characteristics:// Display Technology
        for ($i = 536; $i <= 644; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[12]['table'];
				$revtbl = $table_field_label[12]['revtbl'];
                $field = $table_field_label[12]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Embedded IA Processor Support
        /*for ($i = 645; $i <= 657; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			 $table = $table_field_label[13]['table'];
	$revtbl = $table_field_label[13]['revtbl'];
                $field = $table_field_label[13]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
             
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		*/
        //Generate Script for Characteristics: // End User Organisation
        for ($i = 658; $i <= 662; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[14]['table'];
	$revtbl = $table_field_label[14]['revtbl'];
                $field = $table_field_label[14]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        } 

        //Generate Script for Characteristics: // Ethernet Controllers
        for ($i = 663; $i <= 721; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[15]['table'];
	$revtbl = $table_field_label[15]['revtbl'];
                $field = $table_field_label[15]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Ethernet Standards
        for ($i = 722; $i <= 727; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[16]['table'];
	$revtbl = $table_field_label[16]['revtbl'];
                $field = $table_field_label[16]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // FPGA
        for ($i = 728; $i <= 744; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[17]['table'];
	$revtbl = $table_field_label[17]['revtbl'];
                $field = $table_field_label[17]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Geographic Coverage:
        for ($i = 745; $i <= 770; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[18]['table'];
	$revtbl = $table_field_label[18]['revtbl'];
                $field = $table_field_label[18]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Industries and Applications
        for ($i = 771; $i <= 887; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[19]['table'];
	$revtbl = $table_field_label[19]['revtbl'];
                $field = $table_field_label[19]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
        //Generate Script for Characteristics: // Intel IoT Market Ready Solutions
        for ($i = 888; $i <= 888; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[20]['table'];
	$revtbl = $table_field_label[20]['revtbl'];
                $field = $table_field_label[20]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Intel Technologies
        for ($i = 889; $i <= 908; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[21]['table'];
	$revtbl = $table_field_label[21]['revtbl'];
                $field = $table_field_label[21]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Interconnect
        /*for ($i = 909; $i <= 938; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[22]['table'];
	$revtbl = $table_field_label[22]['revtbl'];
                $field = $table_field_label[22]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
*/
        //Generate Script for Characteristics: // Memory
        for ($i = 939; $i <= 963; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[23]['table'];
	$revtbl = $table_field_label[23]['revtbl'];
                $field = $table_field_label[23]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Opportunity Resource Type
      /*  for ($i = 964; $i <= 973; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[24]['table'];
	$revtbl = $table_field_label[24]['revtbl'];
                $field = $table_field_label[24]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
*/
        //Generate Script for Characteristics: // PCIe Revisions
        for ($i = 974; $i <= 977; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[25]['table'];
	$revtbl = $table_field_label[25]['revtbl'];
                $field = $table_field_label[25]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
       // Generate Script for Characteristics: // Processors
        for ($i = 978; $i <= 1774; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[26]['table'];
	$revtbl = $table_field_label[26]['revtbl'];
                $field = $table_field_label[26]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Software Solutions
        for ($i = 1775; $i <= 1808; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[27]['table'];
	$revtbl = $table_field_label[27]['revtbl'];
                $field = $table_field_label[27]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Storage:
        for ($i = 1809; $i <= 1838; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[28]['table'];
	$revtbl = $table_field_label[28]['revtbl'];
                $field = $table_field_label[28]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
             
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
	
            
	}	
        }
		
        //Generate Script for Characteristics: // Wireless
        for ($i = 1839; $i <= 1882; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[29]['table'];
	$revtbl = $table_field_label[29]['revtbl'];
                $field = $table_field_label[29]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		
		
		
		
		/***** MISSING TAXONOMY ITEMS STARTS HERE ************/
		
		// Generate Script for Characteristics: // Intel Technologies missing
        for ($i = 1941; $i <= 1941; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[21]['table'];
			$revtbl = $table_field_label[21]['revtbl'];
            $field = $table_field_label[21]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		
		// Generate Script for Characteristics: // Industries and Applications missing
        for ($i = 1942; $i <= 1943; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[19]['table'];
	$revtbl = $table_field_label[19]['revtbl'];
                $field = $table_field_label[19]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
		
		/*
		
		//Generate Script for Characteristics:// Display missing
        for ($i = 1944; $i <= 1944; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[9]['table'];
				$revtbl = $table_field_label[9]['revtbl'];
                $field = $table_field_label[9]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		*/
		
		/*
		//Generate Script for Characteristics: // Devices and Interfaces missing
        for ($i = 1945; $i <= 1952; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[7]['table'];
				$revtbl = $table_field_label[7]['revtbl'];
                $field = $table_field_label[7]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		*/
		
		//Generate Script for Characteristics: // Storage missing
		for ($i = 1953; $i <= 1955; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[28]['table'];
				$revtbl = $table_field_label[28]['revtbl'];
                $field = $table_field_label[28]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
						  $delta_value = 0;
						  $entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						  $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                        //Check same delta value exists - increase count if exists
                          if (!isset($entity_id[$table][$nid]['delta_flag']))
                           delta_exists($table, $nid, $entity_id[$table]);
						   $delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_chinese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
	
            
	}	
        }
		
		
		
		/***** MISSING TAXONOMY ITEMS ENDS HERE ************/
		
		
		
		$context['results']['completed_nids'][] = $nid;
		if(count($message[$nid]['insert']) > 0)
		$context['results']['message'][$nid]['insert'][] = $message[$nid]['insert'];
		if(count($message[$nid]['skip']) > 0)
			$context['results']['message'][$nid]['skip'][] = $message[$nid]['skip'];
		if(count($message[$nid]['delete']) > 0)
			$context['results']['message'][$nid]['delete'][] = $message[$nid]['delete'];
		if(count($message[$nid]['h_tanaslation']) > 0)
			$context['results']['message'][$nid]['h_tanaslation'][] = $message[$nid]['h_tanaslation'];
			//unset($entity_id);
		if(count($message[$nid]['no-nid']) > 0)
		$context['results']['message'][$nid]['no-nid'][] = $message[$nid]['no-nid'];
		unset($message);
	}
		 
	}
	
	/*
	End script for chinese language 
	*/

/*
Creating insert,skip and delete script function for japanese language
*/
function csv_to_array_japanese() {

	$form = drupal_get_form('csvImport_japanese_form');
   	$output = "<p>This tool will attempt to import CSV data";
    $output .= drupal_render($form);
    
    return $output;
	//print_r ($output);

 

}

function csvImport_japanese_form() {
    $form['#attributes'] = array(
      'enctype' => 'multipart/form-data'
    );
  
    $form['csvfile'] = array( 
      '#title' => t('CSV File'),
      '#type'  => 'file',
      '#description' => ($max_size = parse_size(ini_get('upload_max_filesize'))) ? t('Due to server restrictions, the <strong>maximum upload file size is !max_size</strong>. Files that exceed this size will be disregarded.', array('!max_size' => format_size($max_size))) : '',    
    ) ;
    $form['submit'] = array(
      '#type' => 'submit',
      '#value' => t('Commence Import'),
    ) ;
    $form['#validate'] = array(
      'csvImport_japanese_validate_fileupload',
      ///'csvImport_form_validate_japanese',
    ) ;
    return $form ;
  }
  
  function csvImport_japanese_validate_fileupload(&$form, &$form_state) {
   $validators = array(
      'file_validate_extensions' => array( 'csv txt xls xlsx'),
    );
    $destination = '';
	$file = file_save_upload('csvfile', $validators, "public://", FILE_EXISTS_RENAME);
	$destination = $file->destination;
    if ($file) {
      $form_state['values']['csvupload'] = $file->destination;       
    }
    else {
      form_set_error('csvImporter', t('Unable to copy upload file to !dest', array('!dest' => $destination)));
    }            
  }
  
    function csvImport_form_validate_japanese(&$form, &$form_state) {
    if ( isset( $form_state['values']['csvupload'] ) ) {
      if ( $handle = fopen($form_state['values']['csvupload'], 'r') ) {
        $line_count = 1 ;
        $first = TRUE ;
        if ( $line = fgetcsv($handle, 0,"\t")) {
  
          //-------------------------------------------------------------------------------------------|
          //  This is where you can validate aspects of the file itself, like the number of columns
          //-------------------------------------------------------------------------------------------|
            if(count($line) != 1939){
              form_set_error('csvfile', t('This file has the incorrect number of columns. Expecting 1939'));
            }
          //-------------------------------------------------------------------------------------------|
          //  End validating aspects of the CSV file
          //-------------------------------------------------------------------------------------------|
          
          
          
        }
        fclose($handle);
      }
      else {
        form_set_error('csvfile', t('Unable to read uploaded file !filepath', array('!filepath' => $form_state['values']['csvupload'])));
      }
    }
  }
    function csvImport_japanese_form_submit(&$form, &$form_state) {
	if ( isset( $form_state['values']['csvupload'] ) ) {
	$result = csv_to_array_form_japanese($form_state['values']['csvupload'] );
	 
	}
	}

/**
 * Read CSV file by converting array - Delta Extraction
 *
 */
function csv_to_array_form_japanese($file_name) {
    $message = $data = $header = array();
    $i = 0;
    $vid = 8000;
	
	//Set Table Name and Field name for terms
    $table_field_label = array(
        0 => array('table' => 'field_data_field_solution_type', 'field' => 'field_solution_type_value','revtbl' => 'field_revision_field_solution_type'),
        1 => array('table' => 'field_data_field_access', 'field' => 'field_access_value','revtbl' => 'field_revision_field_access'),
        2 => array('table' => 'field_data_field_categories', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_categories'),
        3 => array('table' => 'field_data_field_stds_audio', 'field' => 'field_stds_audio_tid','revtbl' => 'field_revision_field_stds_audio'),
        4 => array('table' => 'field_data_field_availability_pricing', 'field' => 'field_availability_pricing_tid','revtbl' => 'field_revision_field_availability_pricing'),
        5 => array('table' => 'field_data_field_power', 'field' => 'field_power_tid','revtbl' => 'field_revision_field_power'),
        6 => array('table' => 'field_data_field_chipsets', 'field' => 'field_chipsets_tid','revtbl' => 'field_revision_field_chipsets'),
        7 => array('table' => 'field_data_field_application', 'field' => 'field_application_tid','revtbl' => 'field_revision_field_application'),
        8 => array('table' => 'field_data_field_dimension', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_dimension'),//no table name change
        9 => array('table' => 'field_data_field_display', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_display'),//no table name change
        10 => array('table' => 'field_data_field_display_size', 'field' => 'field_display_size_tid','revtbl' => 'field_revision_field_display_size'),
        11 => array('table' => 'field_data_field_num_display_ports', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_num_display_ports'),//no table name change
        12 => array('table' => 'field_data_field_display_technology', 'field' => 'field_display_technology_tid','revtbl' => 'field_revision_field_display_technology'),
        13 => array('table' => 'field_data_field_embed_processor', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_embed_processor'),//no table name change
        14 => array('table' => 'field_data_field_end_user_organisation', 'field' => 'field_end_user_organisation_tid','revtbl' => 'field_revision_field_end_user_organisation'),
        15 => array('table' => 'field_data_field_ethernet_controllers', 'field' => 'field_ethernet_controllers_tid','revtbl' => 'field_revision_field_ethernet_controllers'),
        16 => array('table' => 'field_data_field_stds_eth', 'field' => 'field_stds_eth_tid','revtbl' => 'field_revision_field_stds_eth'),
        17 => array('table' => 'field_data_field_fpga', 'field' => 'field_fpga_tid','revtbl' => 'field_revision_field_fpga'),
        18 => array('table' => 'field_data_field_geographic_location', 'field' => 'field_geographic_location_tid','revtbl' => 'field_revision_field_geographic_location'),
        19 => array('table' => 'field_data_field_market_segments', 'field' => 'field_market_segments_tid','revtbl' => 'field_revision_field_market_segments'),
        20 => array('table' => 'field_data_field_intel_iot_market_ready_sol', 'field' => 'field_intel_iot_market_ready_sol_tid','revtbl' => 'field_revision_field_intel_iot_market_ready_sol'),
        21 => array('table' => 'field_data_field_intel_technologies', 'field' => 'field_intel_technologies_tid','revtbl' => 'field_revision_field_intel_technologies'),
        22 => array('table' => 'field_data_field_interconnect', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_interconnect'),//no table name change
        //23 => array('table' => 'field_data_field_memory_type', 'field' => 'field_memory_type_tid','revtbl' => 'field_revision_field_memory_type'),
		23 => array('table' => 'field_data_field_storage', 'field' => 'field_storage_tid','revtbl' => 'field_revision_field_storage'),
        24 => array('table' => 'field_data_field_opportunity_resource', 'field' => 'field_categories_tid','revtbl' => 'field_revision_field_opportunity_resource'),//no table name change
        25 => array('table' => 'field_data_field_stds_pcie_rev', 'field' => 'field_stds_pcie_rev_tid','revtbl' => 'field_revision_field_stds_pcie_rev'),
        26 => array('table' => 'field_data_field_processors_list', 'field' => 'field_processors_list_tid','revtbl' => 'field_revision_field_processors_list'),
        27 => array('table' => 'field_data_field_software_solutions', 'field' => 'field_software_solutions_tid','revtbl' => 'field_revision_field_software_solutions'),
        //28 => array('table' => 'field_data_field_storage', 'field' => 'field_storage_tid','revtbl' => 'field_revision_field_storage'),
		28 => array('table' => 'field_data_field_application', 'field' => 'field_application_tid','revtbl' => 'field_revision_field_application'),
        29 => array('table' => 'field_data_field_intel_wireless', 'field' => 'field_intel_wireless_tid','revtbl' => 'field_revision_field_intel_wireless'),
    );
	
	
    //Read File
    $file = fopen($file_name, 'r');
    while (($line = fgetcsv($file, 0, "\t")) !== FALSE) {
        if ($i == 0) {
            //Set header row
            $header = $line;
        } else {
            //Set Data rows
            //$data[] = $line;
			$operations[] = array(
          'intel_ea_taxonomy_migration_import_batch_processing_japanese',  // The function to run on each row
          array($header,$line,$table_field_label,$vid,$message),  // The row in the csv
        );
        
        $vid++;
        }
        $i++;
    }
    unset($line);
    fclose($file);

    //Map each header and Data with Nid coloumn
    // foreach($data as $key => $_value) {
        // $i = 0;
        // $new_item = array();
        // foreach($_value as $key => $value) {
            // $new_item[$i]['label'] = $header[$key];
            // $new_item[$i]['value'] = $value;
	// $i++;
        // }
        // $_data[] = $new_item;
    // }
    // unset($data);
    // unset($new_item);
    // unset($header);
    // foreach($_data as $value) {
	
	 // $operations[] = array(
          // 'intel_ea_taxonomy_migration_import_batch_processing',  // The function to run on each row
          // array($value,$table_field_label,$vid,$message),  // The row in the csv
        // );
        
        // $vid++;
    // }
	// Once everything is gathered and ready to be processed... well... process it!
      $batch = array(
        'title' => t('Importing CSV...'),
        'operations' => $operations,  // Runs all of the queued processes from the while loop above.
        'finished' => 'module_name_import_finished', // Function to run when the import is successful
        'error_message' => t('The installation has encountered an error.'),
        'progress_message' => t('Imported @current of @total products.'),
      );
      batch_set($batch);
	//batch_process('csvimport');
	
    return $message;
    //return $_data;
}
/**
 * Check Delta exists for correponding values - Delta should be unique combine with entity id
 *
 */
function delta_exists_japanese($tblname, $nid, &$entity_id) {
    $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
    //Get records of delta id for an entity id
    $sql = "SELECT entity_id FROM {$tblname} WHERE entity_id=$nid AND delta=:count_nid limit 1";
	//drupal_set_message($sql);
    if ($result = db_query($sql,array(':count_nid'=>$count_nid))) {
        // Return the number of rows in result set
        $rowcount = $result -> rowCount();
        if ($rowcount) {
            //Get maximum delta value for an entity id
           $sql = "SELECT max(delta) as max FROM {$tblname} WHERE entity_id=:nid limit 1";
	   //drupal_set_message($sql);
            if ($result = db_query($sql,array(':nid'=>$nid))) {
               foreach ($result as $result) {
	// Do something with each $result
	$max = $result->max;
	}
                $entity_id[$nid]['delta_id'][$max + 1] = 'old delta Exists';
                $count_nid = max(array_keys($entity_id[$nid]['delta_id']));
                $entity_id[$nid]['delta_flag'] = true;
            }
        }

    }

}
/* 
Delete Message
*/

function delete_rows_japanese($table,$nid,$field,$data_label_value) {
	$delete_flag = false;
     $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=:data_label_value limit 1";
                if ($result = db_query($sql,array(':data_label_value'=>$data_label_value))) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                       $delete_flag = true;
                    }	
	}
	return $delete_flag;
}

  function module_name_import_finished_japanese($success, $results, $operations) {
	 
	 drupal_set_message(t('Import Completed'));
	
	theme('csvimport_template', array('result' => $results));
	 
	   
  }


    function intel_ea_taxonomy_migration_import_batch_processing_japanese($header,$value,$table_field_label,$vid,$message,&$context) {
		  $nid = $value[0];
                                $source_nid = $value[0]; // preserve source nid for displaying translated message etc.,
                                $language = 'und';
                                
                                /* Multilingual */
                                $other_lang_nid = get_translated_nids_with_language($nid); // get nid as array
                                
                                
                                if (!array_key_exists('ja', $other_lang_nid)) {
                                                return;
                                }
                                $nid = $other_lang_nid['ja'];
                                

                                                
                                //Prevent same nid process again if translated nids occurs in excel
                                if(!in_array($nid,$context['results']['completed_nids']))
                                {
									$vid = db_query('SELECT max(vid) as vid  FROM {node_revision} WHERE nid = :nid ORDER BY vid DESC LIMIT 0,1', array(':nid' => $nid))->fetchField();                                                             
                                                 //Display translation message
                                                if($nid != $source_nid){
													$language_code = db_query('SELECT language FROM {node} WHERE nid = :nid ORDER BY vid DESC LIMIT 0,1', array(':nid' => $nid))->fetchField();//get language code
                                                $language_name = db_query('SELECT name FROM languages WHERE language=:language_code LIMIT 0,1', array(':language_code' => $language_code))->fetchField();// get language name
                                                                $message[$nid]['h_tanaslation']="Node-$nid is translated node - $language_name of node-$source_nid";
												}
			 
		//Generate Script for Solution Types
         for ($i = 3; $i <= 5; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

             //Set corresponding label values
			if ($data_label == 'Client') $data_label_value = 'client';
			if ($data_label == 'Server') $data_label_value = 'server';
			if ($data_label == 'IoT') $data_label_value = 'embedded iot';
			
			
			$table = $table_field_label[0]['table'];
			$revtbl = $table_field_label[0]['revtbl'];
			$field = $table_field_label[0]['field'];
			
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=:data_label_value";
                if ($result = db_query($sql,array(':data_label_value'=>$data_label_value))) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
						//drupal_set_message('skip'.$count_nid);
                        //Skip Message                                                                 
                        //$message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						//drupal_set_message("count$nid--$delta_value--$data_label_value--".$entity_id[$table][$nid]['delta_flag']);
                        //Insert Message
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }

            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
				//if($delete_flag) 
                //$message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field='$data_label_value'";
            
	}	

        }
       

        //Generate Script for View Options
          for ($i = 6; $i <= 8; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            if ($data_label == 'Intel Content') $data_label_value = 2;
            if ($data_label == 'Logged In Content') $data_label_value = 1;
            if ($data_label == 'Public Content') $data_label_value = 0;
			 $table = $table_field_label[1]['table'];
			$revtbl = $table_field_label[1]['revtbl'];
			$field = $table_field_label[1]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                                                 
                        //$message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
 						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
	

                    }
                }

            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
				//if($delete_flag) 
                //$message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
		
        //Generate Script for Category terms
        for ($i = 9; $i <= 183; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
			$data_label_value = explode("~", $data_label);
			$data_label_value = $data_label_value[0];
			
			
			$table = $table_field_label[2]['table'];
			$revtbl = $table_field_label[2]['revtbl'];
			$field = $table_field_label[2]['field'];
			
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
    
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
						//drupal_set_message('skip'.$count_nid);
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						//drupal_set_message("count$nid--$delta_value--$data_label_value--".$entity_id[$table][$nid]['delta_flag']);
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }

            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
        //Generate Script for Characteristics: Audio Standards terms
        for ($i = 184; $i <= 187; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[3]['table'];
			$revtbl = $table_field_label[3]['revtbl'];
			$field = $table_field_label[3]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
             
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                                           $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
				$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Availability & Pricing terms
        for ($i = 188; $i <= 199; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[4]['table'];
				$revtbl = $table_field_label[4]['revtbl'];
                $field = $table_field_label[4]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Battery
        for ($i = 200; $i <= 203; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[5]['table'];
				$revtbl = $table_field_label[5]['revtbl'];
                $field = $table_field_label[5]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Chipsets
        for ($i = 204; $i <= 306; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[6]['table'];
				$revtbl = $table_field_label[6]['revtbl'];
                $field = $table_field_label[6]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                    //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Devices and Interfaces 
        for ($i = 307; $i <= 441; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[7]['table'];
				$revtbl = $table_field_label[7]['revtbl'];
                $field = $table_field_label[7]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                 //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                                $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Dimensions 
       /* for ($i = 442; $i <= 445; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[8]['table'];
				$revtbl = $table_field_label[8]['revtbl'];
                $field = $table_field_label[8]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                    //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics:// Display 
        for ($i = 446; $i <= 479; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[9]['table'];
				$revtbl = $table_field_label[9]['revtbl'];
                $field = $table_field_label[9]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }*/
        //Generate Script for Characteristics:// Display Size 
        for ($i = 480; $i <= 529; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[10]['table'];
				$revtbl = $table_field_label[10]['revtbl'];
                $field = $table_field_label[10]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
    
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics:// Number of Display Ports/EDP Ports
        /*for ($i = 530; $i <= 535; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[11]['table'];
				$revtbl = $table_field_label[11]['revtbl'];
                $field = $table_field_label[11]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }*/

        //Generate Script for Characteristics:// Display Technology
        for ($i = 536; $i <= 644; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[12]['table'];
				$revtbl = $table_field_label[12]['revtbl'];
                $field = $table_field_label[12]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Embedded IA Processor Support
        /*for ($i = 645; $i <= 657; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			 $table = $table_field_label[13]['table'];
	$revtbl = $table_field_label[13]['revtbl'];
                $field = $table_field_label[13]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		*/
        //Generate Script for Characteristics: // End User Organisation
        for ($i = 658; $i <= 662; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[14]['table'];
	$revtbl = $table_field_label[14]['revtbl'];
                $field = $table_field_label[14]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        } 

        //Generate Script for Characteristics: // Ethernet Controllers
        for ($i = 663; $i <= 721; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[15]['table'];
	$revtbl = $table_field_label[15]['revtbl'];
                $field = $table_field_label[15]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Ethernet Standards
        for ($i = 722; $i <= 727; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[16]['table'];
	$revtbl = $table_field_label[16]['revtbl'];
                $field = $table_field_label[16]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // FPGA
        for ($i = 728; $i <= 744; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[17]['table'];
	$revtbl = $table_field_label[17]['revtbl'];
                $field = $table_field_label[17]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: Geographic Coverage:
        for ($i = 745; $i <= 770; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[18]['table'];
	$revtbl = $table_field_label[18]['revtbl'];
                $field = $table_field_label[18]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Industries and Applications
        for ($i = 771; $i <= 887; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[19]['table'];
	$revtbl = $table_field_label[19]['revtbl'];
                $field = $table_field_label[19]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {

                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }

            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
        //Generate Script for Characteristics: // Intel IoT Market Ready Solutions
        for ($i = 888; $i <= 888; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[20]['table'];
	$revtbl = $table_field_label[20]['revtbl'];
                $field = $table_field_label[20]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Intel Technologies
        for ($i = 889; $i <= 908; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[21]['table'];
	$revtbl = $table_field_label[21]['revtbl'];
                $field = $table_field_label[21]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
             
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));
						//Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Interconnect
        /*for ($i = 909; $i <= 938; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[22]['table'];
	$revtbl = $table_field_label[22]['revtbl'];
                $field = $table_field_label[22]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
*/
        //Generate Script for Characteristics: // Memory
        for ($i = 939; $i <= 963; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[23]['table'];
	$revtbl = $table_field_label[23]['revtbl'];
                $field = $table_field_label[23]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Opportunity Resource Type
      /*  for ($i = 964; $i <= 973; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[24]['table'];
	$revtbl = $table_field_label[24]['revtbl'];
                $field = $table_field_label[24]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                  //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
*/
        //Generate Script for Characteristics: // PCIe Revisions
        for ($i = 974; $i <= 977; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[25]['table'];
	$revtbl = $table_field_label[25]['revtbl'];
                $field = $table_field_label[25]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
       // Generate Script for Characteristics: // Processors
        for ($i = 978; $i <= 1774; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[26]['table'];
	$revtbl = $table_field_label[26]['revtbl'];
                $field = $table_field_label[26]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                  //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }

        //Generate Script for Characteristics: // Software Solutions
        for ($i = 1775; $i <= 1808; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[27]['table'];
	$revtbl = $table_field_label[27]['revtbl'];
                $field = $table_field_label[27]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                   //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
        //Generate Script for Characteristics: // Storage:
        for ($i = 1809; $i <= 1838; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[28]['table'];
	$revtbl = $table_field_label[28]['revtbl'];
                $field = $table_field_label[28]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
	
            
	}	
        }
        //Generate Script for Characteristics: // Wireless
        for ($i = 1839; $i <= 1882; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[29]['table'];
	$revtbl = $table_field_label[29]['revtbl'];
                $field = $table_field_label[29]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                  //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }

           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		
		
		
		
		/***** MISSING TAXONOMY ITEMS STARTS HERE ************/
		
		// Generate Script for Characteristics: // Intel Technologies missing
        for ($i = 1941; $i <= 1941; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[21]['table'];
			$revtbl = $table_field_label[21]['revtbl'];
            $field = $table_field_label[21]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		
		// Generate Script for Characteristics: // Industries and Applications missing
        for ($i = 1942; $i <= 1943; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			$table = $table_field_label[19]['table'];
	$revtbl = $table_field_label[19]['revtbl'];
                $field = $table_field_label[19]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
              
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {                        
						$delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));       
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}

                    }
                }
            }

            elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	

        }
		
		/*
		
		//Generate Script for Characteristics:// Display missing
        for ($i = 1944; $i <= 1944; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[9]['table'];
				$revtbl = $table_field_label[9]['revtbl'];
                $field = $table_field_label[9]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                                             $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		*/
		
		/*
		//Generate Script for Characteristics: // Devices and Interfaces missing
        for ($i = 1945; $i <= 1952; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
			
                $table = $table_field_label[7]['table'];
				$revtbl = $table_field_label[7]['revtbl'];
                $field = $table_field_label[7]['field'];
				
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
               
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message[$nid]['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message[$nid]['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
            
	}	
        }
		
		*/
		
		//Generate Script for Characteristics: // Storage missing
		for ($i = 1953; $i <= 1955; $i++) {

            $data_value = $value[$i];
            $data_label = $header[$i];

            //Set corresponding label values
            $data_label_value = explode("~", $data_label);
            $data_label_value = $data_label_value[0];
			
                $table = $table_field_label[28]['table'];
				$revtbl = $table_field_label[28]['revtbl'];
                $field = $table_field_label[28]['field'];
            if (!empty(trim($value[$i])) && trim($value[$i]) == 1) {
                //Check Existing Field value mapped with entity id 
                $sql = "SELECT entity_id FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
                if ($result = db_query($sql)) {
                    // Return the number of rows in result set
                    $rowcount = $result -> rowCount();
                    if ($rowcount) {
                        //Skip Message                                                                 
                        $message['skip'][] = "Table: $table-Skip data due to entityid-$nid and value-$data_label_value already exists";

                    } else {
                        $delta_value = 0;
						$entity_id[$table][$nid]['delta_id'][] = $data_label_value;
						$count_nid = max(array_keys($entity_id[$table][$nid]['delta_id']));

                        //Check same delta value exists - increase count if exists
                        if (!isset($entity_id[$table][$nid]['delta_flag']))
                            delta_exists($table, $nid, $entity_id[$table]);
							$delta_value = max(array_keys($entity_id[$table][$nid]['delta_id']));
						if(empty($vid)){
							// no nid in the database
							$message[$nid]['no-nid'][] = "Table: $table-Skip data due to no entityid-$nid in the DB";
						}
						else {
							//Insert Message
                        $message[$nid]['insert'][] = "INSERT INTO $table VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						$message[$nid]['insert'][] = "INSERT INTO $revtbl VALUES('node','solution',0,$nid,$vid,'$language',$delta_value,'$data_label_value')";
						}
                    }
                }
            }
           elseif (trim($value[$i]) == '') {
                //Delete Message
	$delete_flag = delete_rows_japanese($table,$nid,$field,$data_label_value);
	if($delete_flag) 
                $message['delete'][] = "DELETE FROM $table WHERE entity_id=$nid AND $field=$data_label_value";
	
            
	}	
        }
		
		
		
		/***** MISSING TAXONOMY ITEMS ENDS HERE ************/
		
		
		
		$context['results']['completed_nids'][] = $nid;
		if(count($message[$nid]['insert']) > 0)
		$context['results']['message'][$nid]['insert'][] = $message[$nid]['insert'];
		if(count($message[$nid]['skip']) > 0)
			$context['results']['message'][$nid]['skip'][] = $message[$nid]['skip'];
		if(count($message[$nid]['delete']) > 0)
			$context['results']['message'][$nid]['delete'][] = $message[$nid]['delete'];
		if(count($message[$nid]['h_tanaslation']) > 0)
			$context['results']['message'][$nid]['h_tanaslation'][] = $message[$nid]['h_tanaslation'];
			//unset($entity_id);
		if(count($message[$nid]['no-nid']) > 0)
		$context['results']['message'][$nid]['no-nid'][] = $message[$nid]['no-nid'];
		unset($message);
	}
		 
	}
	
	/*
	End script for japanese language 
	*/
	
		
	
/*
Template file creation
*/
function intel_csvimport_theme() {
    return array(
        'csvimport_template' => array(
            'template' => 'csvimport', // csvimport.tpl.php
        ),

    );
}
